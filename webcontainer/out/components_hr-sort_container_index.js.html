<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/hr-sort/container/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/hr-sort/container/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Created by wanghongxiang on 2019/2/21.
 */
import React, { Component } from 'react';
import PropTypes from 'prop-types'
import {base, ajax, toast, getMultiLang} from 'nc-lightapp-front';
let {NCModal, NCRow, NCCol, NCButton} = base;
const {Header, Title, Body, Footer} = NCModal
import SortBtns from '../components/btns'
import SortTable from '../components/table'
import SortSelect from '../components/select'
import {sortBtns, metaChange, sortTypeChange, formatSelectData, rowClick, confirmBtn, saveBtn} from '../events'
import './index.less'


class HRSort extends Component {
    constructor(props) {
        super(props)
        this.state = {
            show: false,
            meta: null,
            sortType: true,
            index: 0, // 当前选中行
            sortTableData:[], // 排序表格
            metaSource:[], // 下拉 select
            sortList: [],
            selectedRow: [true]
        }

        let callback = (json, status, inlt) => {
            if (status) {
                this.lang = json
                this.setState({json, inlt}, () => {
                    {
                        this.columns = [
                            {title: json['hrpub-000079'], dataIndex: "name", key: "name", width: 100},/* 国际化处理： 字段名称*/
                            {title: json['hrpub-000080'], dataIndex: "sort", key: "sort", width: 100}/* 国际化处理： 升降*/
                        ]
                        this.order = [
                            {key: json['hrpub-000081'], value: true},/* 国际化处理： 升序*/
                            {key: json['hrpub-000082'], value: false}/* 国际化处理： 降序*/
                        ]
                    };
                })//存json和inlt到页面state中并刷新页面
            }
        }
        getMultiLang({moduleId: 'hrpub', domainName: 'hrpub', callback})
        this.cancel = this.cancel.bind(this)
        this.sortBtns = this.sortBtns.bind(this)
        this.propsToState = this.propsToState.bind(this)
        this.sortTypeChange = this.sortTypeChange.bind(this)
        this.metaChange = this.metaChange.bind(this)
        this.rowClick = this.rowClick.bind(this)
        this.confirmBtn = this.confirmBtn.bind(this)
        this.saveBtn = this.saveBtn.bind(this)
    }
    componentWillReceiveProps(nextProps) {
        if (nextProps.data != this.props.data) {
            let {selectedItem, savedItem} = nextProps.data
            let metaSource = formatSelectData(selectedItem),
                sortTableData = formatSelectData(savedItem, {
                    field_code: 'key', field_name: 'name', ascend_flag: 'sort'
                },true,this.state.json)
            this.propsToState({metaSource, sortTableData})
        }
    }
    propsToState(state, func=()=>{}) {
        this.setState({...state}, ()=> {
            func()
        })
    }
    cancel() {
        this.setState({
           show: false
        })
    }
    show(){
        this.setState({
            show:true
        })
    }
    sortBtns(type) {
        this.propsToState(sortBtns(type, this.state))
    }
    metaChange(meta) {
        this.propsToState(metaChange(meta))
    }
    rowClick(record, index, indent) {
        this.propsToState(rowClick(record, index, indent, this.state))
    }
    sortTypeChange(meta) {
        this.propsToState(sortTypeChange(meta))
    }
    confirmBtn() {
        let result = confirmBtn(this.state)
        this.setState({
            show: false
        },() => {
            this.props.confirmCallBack(result)
        })
    }
    saveBtn() {
        let result = saveBtn(this.state)
        this.propsToState({sortList: result}, ()=>{
            this.props.saveCallBack(result)
        })
    }
    render() {
        let {order, columns} = this
        let {metaSource, sortTableData, selectedRow} = this.state
        let modal =  this.state.json ?
                &lt;NCModal show={this.state.show} onHide={this.cancel.bind(this)} size="md" className ="modal">
                    &lt;Header closeButton={true}>
                        &lt;Title>{this.state.json['hrpub-000083']}&lt;/Title>{/* 国际化处理： 新增*/}
                    &lt;/Header>
                    &lt;Body>
                    &lt;NCRow>
                        &lt;NCCol md={10}>
                            &lt;NCRow>
                                &lt;SortSelect
                                    metaSource={metaSource}
                                    order={order}
                                    metaChange={this.metaChange}
                                    sortTypeChange={this.sortTypeChange}
                                />
                            &lt;/NCRow>
                            &lt;NCRow className="modal_table margin0">
                                &lt;SortTable
                                    columns={columns}
                                    rowClick={this.rowClick}
                                    selectedRow={selectedRow}
                                    sortTableData={sortTableData}
                                />
                            &lt;/NCRow>
                        &lt;/NCCol>
                        &lt;NCCol md={2} className="modal_btn">
                            &lt;SortBtns evts={this.sortBtns.bind(this)} json={this.state.json}/>
                        &lt;/NCCol>
                    &lt;/NCRow>
                    &lt;/Body>
                    &lt;Footer>
                        &lt;NCButton colors="danger" shape="border" onClick={this.confirmBtn}>{this.state.json['hrpub-000055']}&lt;/NCButton>
                        &lt;NCButton colors="danger" shape="border" onClick={this.saveBtn}>{this.state.json['hrpub-000046']}&lt;/NCButton>
                        &lt;NCButton shape="border" onClick={this.cancel}>{this.state.json['hrpub-000047']}&lt;/NCButton>
                    &lt;/Footer>
                &lt;/NCModal> : ''
        return (
            &lt;React.Fragment>
                {modal}
            &lt;/React.Fragment>
        )
    }
}
HRSort.propTypes = {
    data: PropTypes.array.isRequired,
    confirmCallBack: PropTypes.func.isRequired,
    saveCallBack: PropTypes.func.isRequired,
}
export default HRSort</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Header.html">Header</a></li><li><a href="Maybe.html">Maybe</a></li><li><a href="orgRefer.html">orgRefer</a></li><li><a href="Pagination.html">Pagination</a></li></ul><h3>Global</h3><ul><li><a href="global.html#allCheckTable">allCheckTable</a></li><li><a href="global.html#data">data</a></li><li><a href="global.html#dealHeader">dealHeader</a></li><li><a href="global.html#debounce">debounce</a></li><li><a href="global.html#fixedCol">fixedCol</a></li><li><a href="global.html#formatSelectData">formatSelectData</a></li><li><a href="global.html#getCookie">getCookie</a></li><li><a href="global.html#handleQueryRefer">handleQueryRefer</a></li><li><a href="global.html#handleTableChangeColor">handleTableChangeColor</a></li><li><a href="global.html#snCreateUIDom">snCreateUIDom</a></li><li><a href="global.html#sortBtns">sortBtns</a></li><li><a href="global.html#transRadio">transRadio</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Mar 21 2019 10:52:14 GMT+0800 (GMT+08:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
